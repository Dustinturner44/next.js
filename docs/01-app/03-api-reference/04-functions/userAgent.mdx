---
title: userAgent
description: Parses the User-Agent header and returns structured information about the client.
---

{/* The content of this doc is shared between the app and pages router. You can use the `<PagesOnly>Content</PagesOnly>` component to add content that is specific to the Pages Router. Any shared content should not be wrapped in a component. */}

The `userAgent` helper parses the request's `User-Agent` header and returns structured information about the client's browser, device, engine, OS, CPU, and whether the client is a known bot.

```ts filename="middleware.ts" switcher
import { NextRequest, NextResponse, userAgent } from 'next/server'

export function middleware(request: NextRequest) {
  const url = request.nextUrl
  const { device } = userAgent(request)

  // device.type can be: 'mobile', 'tablet', 'console', 'smarttv',
  // 'wearable', 'embedded', or undefined when not present (commonly desktop)
  const viewport = device.type || 'desktop'

  url.searchParams.set('viewport', viewport)
  return NextResponse.rewrite(url)
}
```

```js filename="middleware.js" switcher
import { NextResponse, userAgent } from 'next/server'

export function middleware(request) {
  const url = request.nextUrl
  const { device } = userAgent(request)

  // device.type can be: 'mobile', 'tablet', 'console', 'smarttv',
  // 'wearable', 'embedded', or undefined when not present (commonly desktop)
  const viewport = device.type || 'desktop'

  url.searchParams.set('viewport', viewport)
  return NextResponse.rewrite(url)
}
```

## Reference

From a Request in Middleware or Route Handlers, parse and inspect User Agent fields.

```ts
import { userAgent } from 'next/server'

const ua = userAgent(request)
```

`request` can be either a standard [Web API `Request`](https://developer.mozilla.org/docs/Web/API/Request) or a [`NextRequest`](/docs/app/api-reference/functions/next-request).

### When you only have the User-Agent string

Use `userAgentFromString` to parse a raw User-Agent string.

```ts
import { userAgentFromString } from 'next/server'

// From a raw User-Agent string
const ua = userAgentFromString(uaString)
// ua.isBot, ua.device.type, etc.
```

## Returns

Both helpers return a structured object describing the client and a bot flag.

```ts
type UserAgent = {
  isBot: boolean
  ua: string
  browser: { name?: string; version?: string; major?: string }
  device: {
    model?: string
    type?:
      | 'mobile'
      | 'tablet'
      | 'console'
      | 'smarttv'
      | 'wearable'
      | 'embedded'
      | undefined
    vendor?: string
  }
  engine: { name?: string; version?: string }
  os: { name?: string; version?: string }
  cpu: { architecture?: string }
}
```

- `isBot`: Whether the request appears to come from a bot. Next.js maintains [a list of known bots](https://github.com/vercel/next.js/blob/92f23dae971044dfb49f7bbbf29f02c64f6ce7b3/packages/next/src/server/web/spec-extension/user-agent.ts#L29-L33).
- `ua`: Raw User-Agent header string. May be empty if the header is missing.
- `browser`: `{ name?, version?, major? }` Browser identifier and version information.
- `device`: `{ model?, type?, vendor? }` Device details. `type` can be `mobile`, `tablet`, `console`, `smarttv`, `wearable`, `embedded`, or `undefined`. When `type` is `undefined`, the device might be desktop, but it is not guaranteed.
- `engine`: `{ name?, version? }` Rendering engine details. Common engine name values include `Amaya`, `Blink`, `EdgeHTML`, `Flow`, `Gecko`, `Goanna`, `iCab`, `KHTML`, `Links`, `Lynx`, `NetFront`, `NetSurf`, `Presto`, `Tasman`, `Trident`, `w3m`, `WebKit` or `undefined`.
- `os`: `{ name?, version? }` Operating system details.
- `cpu`: `{ architecture? }` CPU architecture when available. Possible architecture values include `68k`, `amd64`, `arm`, `arm64`, `armhf`, `avr`, `ia32`, `ia64`, `irix`, `irix64`, `mips`, `mips64`, `pa-risc`, `ppc`, `sparc`, `sparc64` or `undefined`.

<AppOnly>

## Example: Route Handler

Return JSON with `isBot` and a device hint.

```ts filename="app/api/ua/route.ts" switcher
import { NextResponse, userAgent } from 'next/server'

export function GET(request: Request) {
  const ua = userAgent(request)
  return NextResponse.json({
    isBot: ua.isBot,
    device: ua.device.type || 'unknown',
  })
}
```

```js filename="app/api/ua/route.js" switcher
import { NextResponse, userAgent } from 'next/server'

export function GET(request) {
  const ua = userAgent(request)
  return NextResponse.json({
    isBot: ua.isBot,
    device: ua.device.type || 'unknown',
  })
}
```

> **Good to know**
>
> - Works in [Middleware](/docs/app/api-reference/file-conventions/middleware) and [Route Handlers](/docs/app/api-reference/file-conventions/route) with `userAgent(request)`.
> - In App Router, read the header with [`headers()`](/docs/app/api-reference/functions/headers) and use `userAgentFromString`.
> - User-Agent strings can be spoofed or empty. Avoid using them for security decisions.

</AppOnly>

<PagesOnly>

## Example: API Route

In Pages Router API Routes, parse the `User-Agent` header from `req`.

```ts filename="pages/api/ua.ts" switcher
import type { NextApiRequest, NextApiResponse } from 'next'
import { userAgentFromString } from 'next/server'

export default function handler(req: NextApiRequest, res: NextApiResponse) {
  const ua = userAgentFromString(
    req.headers['user-agent'] as string | undefined
  )
  res.status(200).json({
    isBot: ua.isBot,
    device: ua.device.type || 'unknown',
  })
}
```

```js filename="pages/api/ua.js" switcher
import { userAgentFromString } from 'next/server'

export default function handler(req, res) {
  const ua = userAgentFromString(req.headers['user-agent'])
  res.status(200).json({
    isBot: ua.isBot,
    device: ua.device.type || 'unknown',
  })
}
```

> **Good to know**
>
> - In [`getServerSideProps`](/docs/pages/building-your-application/data-fetching/get-server-side-props) and [API Routes](/docs/pages/building-your-application/routing/api-routes), use `userAgentFromString(req.headers['user-agent'])`.
> - User-Agent strings can be spoofed or empty. Avoid using them for security decisions.

</PagesOnly>
